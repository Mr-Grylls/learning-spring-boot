<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.OrdersDao">
		<!-- 	根据用户uid查询订单信息 -->
		<select id="selectOrdersById" parameterType="Integer" resultType="com.pojo.Orders">
			select * from orders where user_id=#{id}
		</select>
		
		<!-- 	多对多级联查询 -->
		<resultMap type="com.pojo.Orders" id="allOrdersAndProducts">
			<id property="id" column="id"/>
			<result property="ordersn" column="ordersn"/>
			<collection property="products" ofType="com.pojo.Product">
				<id property="id" column="pid"/>
				<result property="name" column="name"/>
				<result property="price" column="price"/>
			</collection>
		</resultMap>
		<select id="selectallOrdersAndProducts" resultMap="allOrdersAndProducts">
			select o.*,p.id as pid,p.name,p.price 
			from orders o,product p,order_detail od
			where od.orders_id=o.id and od.product_id=p.id
		</select>
</mapper>